<view class="container">
  <!-- å‘å¸ƒä»»åŠ¡åŒºåŸŸ -->
  <view class="card">
    <view class="card-title">å‘å¸ƒä»»åŠ¡</view>
    <form bindsubmit="onAddTask">
      <view class="form-item">
        <input name="title" placeholder="ä»»åŠ¡åç§°ï¼Œä¾‹å¦‚ï¼šåˆ·3é“LeetCode" class="form-input" />
      </view>
      <view class="form-item">
        <input name="description" placeholder="ä»»åŠ¡æè¿°ï¼ˆå¯é€‰ï¼‰" class="form-input" />
      </view>
      <view class="form-row">
        <view class="form-item-half">
          <input name="rewardAttr" placeholder="å¥–åŠ±å±æ€§" class="form-input" value="è‡ªå¾‹èƒ½åŠ›" />
        </view>
        <view class="form-item-half">
          <input name="rewardExp" placeholder="å¥–åŠ±ç»éªŒ" type="number" class="form-input" value="10" />
        </view>
      </view>
      <button formType="submit" class="btn-primary">æ–°å¢ä»»åŠ¡</button>
    </form>
    
    <view class="divider"></view>
    
    <button class="btn-secondary" bindtap="onImportFromChat">
      <text class="btn-icon">ğŸ“¥</text>
      <text>ä»èŠå¤©è®°å½•å¯¼å…¥ä»»åŠ¡</text>
    </button>
  </view>

  <!-- ä»»åŠ¡åˆ—è¡¨ -->
  <view class="card">
    <view class="card-title">ä»»åŠ¡åˆ—è¡¨ ({{tasks.length}})</view>
    
    <view wx:if="{{tasks.length === 0}}" class="empty-state">
      <text class="empty-text">æš‚æ— ä»»åŠ¡</text>
      <text class="empty-hint">åˆ›å»ºæ–°ä»»åŠ¡æˆ–ä»èŠå¤©è®°å½•å¯¼å…¥</text>
    </view>
    
    <view wx:for="{{tasks}}" wx:key="id" class="task-item">
      <view class="task-header">
        <view class="task-title-row">
          <text class="task-title">{{item.title}}</text>
          <view wx:if="{{item.source === 'ai_import'}}" class="task-badge ai-badge">AIå¯¼å…¥</view>
        </view>
        <view wx:if="{{item.description}}" class="task-description">{{item.description}}</view>
      </view>
      
      <!-- è¿›åº¦æ¡ -->
      <view wx:if="{{!item.done}}" class="progress-section">
        <view class="progress-info">
          <text class="progress-text">å®Œæˆè¿›åº¦</text>
          <text class="progress-percent">{{item.progress || 0}}%</text>
        </view>
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{item.progress || 0}}%; background-color: {{item.progress >= 90 ? '#34C759' : item.progress >= 70 ? '#007AFF' : item.progress >= 50 ? '#FF9500' : '#FF3B30'}}"></view>
        </view>
      </view>
      
      <!-- ä»»åŠ¡ä¿¡æ¯ -->
      <view class="task-info">
        <view class="task-reward">
          <text class="reward-label">å¥–åŠ±ï¼š</text>
          <text class="reward-value">{{item.rewardAttr}} +{{item.rewardExp}}</text>
        </view>
        <view wx:if="{{item.done && item.rating}}" class="task-rating">
          <text class="rating-label">è¯„çº§ï¼š</text>
          <text class="rating-value" style="color: {{item.rating === 'excellent' ? '#34C759' : item.rating === 'good' ? '#007AFF' : item.rating === 'normal' ? '#FF9500' : '#FF3B30'}}">
            {{item.rating === 'excellent' ? 'ä¼˜ç§€' : item.rating === 'good' ? 'è‰¯å¥½' : item.rating === 'normal' ? 'æ™®é€š' : 'è¾ƒå·®'}}
          </text>
        </view>
      </view>
      
      <!-- æ“ä½œæŒ‰é’® -->
      <view class="task-actions">
        <button wx:if="{{!item.done}}" class="btn-complete" bindtap="onComplete" data-id="{{item.id}}">
          å®Œæˆä»»åŠ¡
        </button>
        <view wx:else class="task-status">
          <text class="status-text">âœ“ å·²å®Œæˆ</text>
          <text wx:if="{{item.rating}}" class="status-rating">
            ({{item.rating === 'excellent' ? 'ä¼˜ç§€' : item.rating === 'good' ? 'è‰¯å¥½' : item.rating === 'normal' ? 'æ™®é€š' : 'è¾ƒå·®'}})
          </text>
        </view>
      </view>
    </view>
  </view>

  <!-- å¯¼å…¥ä»»åŠ¡ç¡®è®¤å¼¹çª— -->
  <view wx:if="{{showImportModal}}" class="modal-overlay" bindtap="onCancelImport">
    <view class="modal-content" catchtap="">
      <view class="modal-header">
        <text class="modal-title">ä»èŠå¤©è®°å½•å¯¼å…¥ä»»åŠ¡</text>
      </view>
      <view class="modal-body">
        <text class="modal-text">å°†ä»æ‚¨çš„èŠå¤©è®°å½•ä¸­æå–ä»»åŠ¡ä¿¡æ¯ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ</text>
      </view>
      <view class="modal-footer">
        <button class="modal-btn cancel-btn" bindtap="onCancelImport">å–æ¶ˆ</button>
        <button class="modal-btn confirm-btn" bindtap="onConfirmImport" disabled="{{importing}}">
          {{importing ? 'å¯¼å…¥ä¸­...' : 'ç¡®è®¤å¯¼å…¥'}}
        </button>
      </view>
    </view>
  </view>
</view>
